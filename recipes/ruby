################
## Ruby Setup ##
################

hlog "Configuring Ruby"

# TODO: Get the latest version dynamically
ruby_version="2.2.0"

brewui 'rbenv'
echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.zshrc
echo 'eval "$(rbenv init -)"' >> ~/.zshrc
eval "$(rbenv init -)"

brewui 'rbenv-gem-rehash'
brewui 'ruby-build'

log "installing Ruby $ruby_version"
rbenv install -s "$ruby_version"

log "setting ruby $ruby_version as the global default"
rbenv global "$ruby_version"
rbenv rehash


#######################
## Nice-To-Have Gems ##
#######################

log "updating to the latests rubygems version"
gem update --system

log "installing bundler"
gem install bundler --no-document

log "configuring bundler"
number_of_cores=$(sysctl -n hw.ncpu)
bundle config --global jobs $((number_of_cores - 1))

log "installing rails"
gem install rails --no-document

log "installing parity"
gem install parity --no-document

log "configuring postgres gem"
bundle config build.pg --with-pg-config=/Applications/Postgres.app/Contents/Versions/9.3/bin/pg_config
gem install pg -- --with-pg-config=/Applications/Postgres.app/Contents/Versions/9.3/bin/pg_config

log "installing hcl (harvest command line)"
gem install hcl

log "installing tmuxinator gem"
gem install tmuxinator
